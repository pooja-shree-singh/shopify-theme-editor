{{ 'change-password.css' | asset_url | stylesheet_tag }}

<script src="{{ 'change-password.js' | asset_url }}" defer="defer"></script>

<form id="change-password-form">
  <input type="hidden" id="Email" name="customer[email]" value="{{ customer.email }}">
    <label for="current-password">Current Password</label>
    <input type="password" id="current-password" name="current_password" required>

    <label for="new-password">New Password</label>
    <input type="password" id="new-password" name="new_password" required>

    <label for="confirm-password">Confirm New Password</label>
    <input type="password" id="confirm-password" name="confirm_password" required>

    <button type="submit">Change Password</button>
</form>

<script>
    document.getElementById('change-password-form').addEventListener('submit', function(event) {
        event.preventDefault();

        const currentPassword = document.getElementById('current-password').value;
        const newPassword = document.getElementById('new-password').value;
        const confirmPassword = document.getElementById('confirm-password').value;

        if (newPassword !== confirmPassword) {
            alert('New passwords do not match.');
            return;
        }

        // Use Fetch API to send a POST request to change the password
        fetch('/account', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                current_password: currentPassword,
                new_password: newPassword,
                confirm_password: confirmPassword,
            }),
        })
        .then(response => {
            if (response.ok) {
                alert('Password changed successfully.');
            } else {
                alert('Failed to change password. Please try again.');
            }
        })
        .catch(error => console.error('Error:', error));
    });
</script>
